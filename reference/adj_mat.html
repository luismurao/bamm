<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>adj_mat: Function to compute the adjacency matrix of an area. — adj_mat • bamm</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="adj_mat: Function to compute the adjacency matrix of an area. — adj_mat"><meta name="description" content="Creates an adjacency matrix of an area of interest.
This could be the accessible area (M) of a species or any geographic
region of interest."><meta property="og:description" content="Creates an adjacency matrix of an area of interest.
This could be the accessible area (M) of a species or any geographic
region of interest."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bamm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bam.html">bamm</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luismurao/bamm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>adj_mat: Function to compute the adjacency matrix of an area.</h1>
      <small class="dont-index">Source: <a href="https://github.com/luismurao/bamm/blob/master/R/adj_mat.R" class="external-link"><code>R/adj_mat.R</code></a></small>
      <div class="d-none name"><code>adj_mat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an adjacency matrix of an area of interest.
This could be the accessible area (M) of a species or any geographic
region of interest.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">adj_mat</span><span class="op">(</span><span class="va">modelsparse</span>, ngbs <span class="op">=</span> <span class="fl">1</span>, eigen_sys <span class="op">=</span> <span class="cn">FALSE</span>, which_eigs <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-modelsparse">modelsparse<a class="anchor" aria-label="anchor" href="#arg-modelsparse"></a></dt>
<dd><p>A setA object returned by the function
<code><a href="model2sparse.html">model2sparse</a></code>.</p></dd>


<dt id="arg-ngbs">ngbs<a class="anchor" aria-label="anchor" href="#arg-ngbs"></a></dt>
<dd><p>Numeric. Number of neighbors (see details).</p></dd>


<dt id="arg-eigen-sys">eigen_sys<a class="anchor" aria-label="anchor" href="#arg-eigen-sys"></a></dt>
<dd><p>Logical. If TRUE the eigen analyses of the
adjacency matrix will be returned.</p></dd>


<dt id="arg-which-eigs">which_eigs<a class="anchor" aria-label="anchor" href="#arg-which-eigs"></a></dt>
<dd><p>Numeric. Which eigen value and eigen vector will
be returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code><a href="setM-class.html">setM</a></code> with 7 slots.
The first contains the adjacency matrix. A n x n sparse matrix (n=number of
non-NA cells of the niche model) where connected cells are represented by 1.
The second slot has the adjacency list. It is a list of matrices with four
columns (FromRasCell -from cell ID of the raster-, -to cell ID of the
raster-, -from non-NA cell-, -to non-NA cell-). Other slots contain
information about initial coordinates where dispersal occurs
(initial_points), number of cells used to define the neighborhood (ngbs),
non-NA coordinates (coordinates), and a matrix of eigen vectors (eigen_vec).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The model is a raster object of the area where the dispersal
process will occur.
The number of neighbors depends on the dispersal abilities of the species
and the spatial resolution of the niche model; for example, a species's
with big dispersal abilities will move throughout more than 1 km^2 per day,
so the idea is to give an approximate number of moving neighbors (pixels)
per unit of time.
For more information about see adjacency matrices in the context of
the theory of area of distribution (Soberon and Osorio-Olvera, 2022).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Soberón J, Osorio-Olvera L (2023).
“A dynamic theory of the area of distribution.”
<em>Journal of Biogeography6</em>, <b>50</b>, 1037-1048.
<a href="https://doi.org/10.1111/jbi.14587" class="external-link">doi:10.1111/jbi.14587</a>
, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/jbi.14587" class="external-link">https://onlinelibrary.wiley.com/doi/abs/10.1111/jbi.14587</a>.
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Luis Osorio-Olvera &amp; Jorge Soberón</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x_coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">106.5699</span>, <span class="op">-</span><span class="fl">111.3737</span>,<span class="op">-</span><span class="fl">113.9332</span>,</span></span>
<span class="r-in"><span>             <span class="op">-</span><span class="fl">110.8913</span>, <span class="op">-</span><span class="fl">106.4262</span>, <span class="op">-</span><span class="fl">106.5699</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16.62661</span>, <span class="fl">17.72373</span>, <span class="fl">19.87618</span>,</span></span>
<span class="r-in"><span>             <span class="fl">22.50763</span>, <span class="fl">21.37728</span>, <span class="fl">16.62661</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x_coord</span>, <span class="va">y_coord</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://edzer.github.io/sp/reference/SpatialPolygons.html" class="external-link">Polygon</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://edzer.github.io/sp/reference/SpatialPolygons.html" class="external-link">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sps</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://edzer.github.io/sp/reference/SpatialPolygons.html" class="external-link">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mx_grid</span> <span class="op">&lt;-</span> <span class="fu">bamm</span><span class="fu">::</span><span class="fu"><a href="shape2Grid.html">shape2Grid</a></span><span class="op">(</span><span class="va">sps</span>,resolution <span class="op">=</span> <span class="fl">0.25</span>,ones <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mx_sparse</span> <span class="op">&lt;-</span> <span class="fu">bamm</span><span class="fu">::</span><span class="fu"><a href="model2sparse.html">model2sparse</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">mx_grid</span>, threshold <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adj_mx</span> <span class="op">&lt;-</span> <span class="fu">bamm</span><span class="fu">::</span><span class="fu">adj_mat</span><span class="op">(</span>modelsparse<span class="op">=</span><span class="va">mx_sparse</span>,</span></span>
<span class="r-in"><span>                        ngbs<span class="op">=</span><span class="fl">1</span>,eigen_sys<span class="op">=</span><span class="cn">TRUE</span>,which_eigs<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">adj_mx</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Set M of the BAM digram it contains 7 slots </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @coordinates: A matrix with longitude and latitude values of each cell of the raster area</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              x        y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -110.8082 22.38263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -110.5582 22.38263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -111.3082 22.13263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -111.0582 22.13263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -110.8082 22.13263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -110.5582 22.13263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @eigen_val: Eigen values of the connectivity matrix M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.879909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> @eigen_vec: Eigen vector of the connectivity matrix M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.005016999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.005372111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.006135915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.009435098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.011856916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -0.012869369</span>
<span class="r-in"><span><span class="va">mx_grid_eigen</span> <span class="op">&lt;-</span> <span class="va">mx_grid</span></span></span>
<span class="r-in"><span><span class="va">mx_grid_eigen</span><span class="op">[</span><span class="va">mx_sparse</span><span class="op">@</span><span class="va">cellIDs</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">adj_mx</span><span class="op">@</span><span class="va">eigen_vec</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mx_grid_eigen</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="adj_mat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luis Osorio-Olvera, Jorge Soberón.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

